<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>School Website</title>
</head>
<body>
  <h1>📚 School Website</h1>

  <h2>Add Student</h2>
  <form id="studentForm">
    <input type="text" name="name" placeholder="Name" required>
    <input type="email" name="email" placeholder="Email" required>
    <input type="text" name="grade" placeholder="Grade" required>
    <button type="submit">Add Student</button>
  </form>

  <h2>Student List</h2>
  <ul id="studentList"></ul>

  <script>
    const studentForm = document.getElementById("studentForm");
    const studentList = document.getElementById("studentList");

    async function loadStudents() {
      const res = await fetch("/students");
      const students = await res.json();
      studentList.innerHTML = students.map(s => 
        `<li>${s.name} (${s.grade}) <button onclick="deleteStudent(${s.id})">❌</button></li>`
      ).join("");
    }

    studentForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(studentForm);
      await fetch("/students", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          name: formData.get("name"),
          email: formData.get("email"),
          grade: formData.get("grade")
        })
      });
      studentForm.reset();
      loadStudents();
    });

    async function deleteStudent(id) {
      await fetch(`/students/${id}`, { method: "DELETE" });
      loadStudents();
    }

    loadStudents();
  </script>
</body>
</html>
